FROM n8nio/n8n:latest

# Switch to root to install packages and copy scripts
USER root

# Install wget for healthcheck (if not already available)
RUN apk add --no-cache wget

# Copy auto-import scripts
COPY scripts/n8n-auto-import.sh /auto-import.sh
COPY scripts/n8n-entrypoint.sh /custom-entrypoint.sh

# Make scripts executable
RUN chmod +x /auto-import.sh /custom-entrypoint.sh

# Switch back to node user
USER node

# Use custom entrypoint
ENTRYPOINT ["/custom-entrypoint.sh"]
CMD ["n8n"]